<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Free Indian Accent Speech Test with Web Speech API</title>
  </head>
  <body>
    <h1>Test Free Indian Accent Voices</h1>
    <select id="voiceSelect">
      <option value="" disabled selected>Select a voice</option>
    </select>
    <textarea id="textInput" rows="5" cols="70">
What is Friction?
Imagine you're trying to slide a heavy box across the floor. What makes it hard to move? That's friction! Friction is like a force that resists motion when two surfaces rub against each other. It's what makes things slow down or stop.</textarea
    >
    <button onclick="playSpeech()">Test Speech</button>
    <button onclick="stopSpeech()">Stop Speech</button>
    <p id="status">Status: Ready</p>

    <script>
      const synth = window.speechSynthesis;
      const voiceSelect = document.getElementById("voiceSelect");
      const statusElement = document.getElementById("status");
      let utterance = null;

      function populateVoiceList() {
        voiceSelect.innerHTML =
          '<option value="" disabled selected>Select a voice</option>';
        const voices = synth.getVoices();
        const indianVoices = voices.filter((voice) => voice.lang === "en-IN");
        console.log("Indian English voices:", indianVoices);

        if (indianVoices.length > 0) {
          // Sort voices to prioritize Heera before Ravi
          indianVoices.sort((a, b) => {
            if (a.name.includes("Heera")) return -1;
            if (b.name.includes("Heera")) return 1;
            return a.name.localeCompare(b.name);
          });

          indianVoices.forEach((voice) => {
            const option = document.createElement("option");
            option.value = voice.name;
            option.textContent = `${voice.name} (${voice.lang})`;
            voiceSelect.appendChild(option);
          });
        } else {
          voiceSelect.innerHTML =
            '<option value="">No Indian English voices available</option>';
        }
      }
      function playSpeech() {
        const textInput = document.getElementById("textInput");
        const selectedVoiceName = voiceSelect.value;
        const selectedVoice = synth
          .getVoices()
          .find((voice) => voice.name === selectedVoiceName);

        if (selectedVoice && textInput.value) {
          utterance = new SpeechSynthesisUtterance(textInput.value);
          utterance.voice = selectedVoice;
          utterance.lang = "en-IN";

          // Decrease speed only for the male voice (e.g., Microsoft Ravi)
          if (selectedVoiceName.includes("Ravi")) {
            utterance.rate = 0.6; // 30% slower for male voice
          } else {
            utterance.rate = 1.0; // Default speed for female or other voices
          }

          synth.speak(utterance);
          statusElement.textContent = "Status: Speaking...";
        } else {
          statusElement.textContent =
            "Status: Please select a voice and enter text.";
        }
      }
      function stopSpeech() {
        if (synth.speaking) {
          synth.cancel();
          statusElement.textContent = "Status: Stopped";
        } else {
          statusElement.textContent = "Status: No speech playing.";
        }
      }

      // Handle asynchronous voice loading
      if (speechSynthesis.onvoiceschanged !== undefined) {
        speechSynthesis.onvoiceschanged = populateVoiceList;
      }
      populateVoiceList(); // Initial call for browsers that load voices synchronously
    </script>
  </body>
</html>
