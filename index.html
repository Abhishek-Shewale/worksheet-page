<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>English Olympiad Pre-Guide - Class {CLASS_LEVEL}</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <style>
      /* Custom styles for the guide */
      .guide-container {
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
        background-color: #f9f9f9;
        border-radius: 10px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }
      .section {
        margin-bottom: 30px;
        padding: 20px;
        background-color: white;
        border-radius: 8px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
      }
      .section-title {
        font-size: 1.5rem;
        font-weight: bold;
        color: #2563eb;
        margin-bottom: 15px;
        border-bottom: 2px solid #e5e7eb;
        padding-bottom: 10px;
      }
      .sub-section-title {
        font-size: 1.2rem;
        font-weight: 600;
        color: #1f2937;
        margin-top: 15px;
        margin-bottom: 10px;
      }
      .fact-box {
        background-color: #e0f2fe;
        border-left: 4px solid #0ea5e9;
        padding: 10px 15px;
        margin: 15px 0;
        border-radius: 4px;
        font-style: italic;
      }
      .tip-box {
        background-color: #f0fdf4;
        border-left: 4px solid #10b981;
        padding: 10px 15px;
        margin: 15px 0;
        border-radius: 4px;
      }
      .table-container {
        overflow-x: auto;
        margin: 15px 0;
      }
      table {
        width: 100%;
        border-collapse: collapse;
      }
      th,
      td {
        border: 1px solid #e5e7eb;
        padding: 8px 12px;
        text-align: left;
      }
      th {
        background-color: #f3f4f6;
        font-weight: 600;
      }
      .highlight {
        background-color: #fef3c7;
        padding: 2px 5px;
        border-radius: 3px;
      }
      .bullet-list {
        list-style-type: disc;
        margin-left: 20px;
      }
    </style>
  </head>
  <body class="bg-gray-50">
    <div class="container mx-auto px-4 py-8">
      <!-- Header -->
      <header class="text-center mb-8">
        <h1 class="text-3xl font-bold text-gray-800 mb-2">
          English Olympiad Pre-Guide
        </h1>
        <p class="text-lg text-gray-600">
          For Class
          <span id="class-level" class="font-bold text-blue-600">4</span>
        </p>
      </header>

      <!-- Class Selection -->
      <div class="mb-6">
        <label
          for="class-select"
          class="block text-sm font-medium text-gray-700 mb-2"
          >Select Class Level:</label
        >
        <select id="class-select" class="p-2 border border-gray-300 rounded-md">
          <option value="4">Class 4</option>
          <option value="5">Class 5</option>
          <option value="6">Class 6</option>
          <option value="7">Class 7</option>
          <option value="8">Class 8</option>
          <option value="9">Class 9</option>
          <option value="10">Class 10</option>
        </select>
        <button
          id="generate-btn"
          class="ml-4 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700"
        >
          Generate Guide
        </button>
      </div>

      <!-- Loading State -->
      <div id="loading" class="text-center hidden">
        <div
          class="inline-block animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-500"
        ></div>
        <p class="mt-2 text-gray-600">Generating your guide...</p>
      </div>

      <!-- Guide Container -->
      <div id="guide-container" class="guide-container hidden">
        <!-- Introduction Section -->
        <div class="section">
          <h2 class="section-title">1. Introduction</h2>
          <div id="introduction-content"></div>
        </div>

        <!-- Syllabus Snapshot Section -->
        <div class="section">
          <h2 class="section-title">2. Syllabus Snapshot</h2>
          <div id="syllabus-content"></div>
        </div>

        <!-- Exam Pattern Section -->
        <div class="section">
          <h2 class="section-title">3. Exam Pattern</h2>
          <div id="exam-pattern-content"></div>
        </div>

        <!-- Preparation Strategy Section -->
        <div class="section">
          <h2 class="section-title">4. Preparation Strategy</h2>
          <div id="preparation-strategy-content"></div>
        </div>

        <!-- Quick Grammar Rules Section -->
        <div class="section">
          <h2 class="section-title">5. Quick Grammar Rules</h2>
          <div id="grammar-rules-content"></div>
        </div>

        <!-- Vocabulary Boosters Section -->
        <div class="section">
          <h2 class="section-title">6. Vocabulary Boosters</h2>
          <div id="vocabulary-content"></div>
        </div>

        <!-- Reading Comprehension Tips Section -->
        <div class="section">
          <h2 class="section-title">7. Reading Comprehension Tips</h2>
          <div id="reading-tips-content"></div>
        </div>

        <!-- Motivation & Self-Assessment Section -->
        <div class="section">
          <h2 class="section-title">8. Motivation & Self-Assessment</h2>
          <div id="motivation-content"></div>
        </div>
      </div>
    </div>

    <!-- JavaScript to Fetch and Display Guide -->
    <script>
      document
        .getElementById("generate-btn")
        .addEventListener("click", async () => {
          const classLevel = document.getElementById("class-select").value;
          document.getElementById("class-level").textContent = classLevel;
          document.getElementById("loading").classList.remove("hidden");
          document.getElementById("guide-container").classList.add("hidden");

          try {
            const response = await fetch(
              "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=AIzaSyAfzmPZwL-fGE0pOzzUiF0jNlOLsrY4Uus",
              {
                method: "POST",
                headers: {
                  "Content-Type": "application/json",
                },
                body: JSON.stringify({
                  contents: [
                    {
                      role: "user",
                      parts: [
                        {
                          text: `Generate a detailed pre-guide for English Olympiad for Class ${classLevel}.
Return the response in clean HTML with these exact tags:
<introduction>...</introduction>
<syllabus_snapshot>...</syllabus_snapshot>
<exam_pattern>...</exam_pattern>
<preparation_strategy>...</preparation_strategy>
<grammar_rules>...</grammar_rules>
<vocabulary_boosters>...</vocabulary_boosters>
<reading_tips>...</reading_tips>
<motivation>...</motivation>`,
                        },
                      ],
                    },
                  ],
                }),
              }
            );

            if (!response.ok) {
              throw new Error("Failed to fetch guide");
            }

            const guideData = await response.json();

            // Extract text from Gemini response
            const textOutput =
              guideData.candidates?.[0]?.content?.parts?.[0]?.text || "";

            // Parse response HTML into a document
            const parser = new DOMParser();
            const doc = parser.parseFromString(textOutput, "text/html");

            // Populate each section
            document.getElementById("introduction-content").innerHTML =
              doc.querySelector("introduction")?.innerHTML || "";
            document.getElementById("syllabus-content").innerHTML =
              doc.querySelector("syllabus_snapshot")?.innerHTML || "";
            document.getElementById("exam-pattern-content").innerHTML =
              doc.querySelector("exam_pattern")?.innerHTML || "";
            document.getElementById("preparation-strategy-content").innerHTML =
              doc.querySelector("preparation_strategy")?.innerHTML || "";
            document.getElementById("grammar-rules-content").innerHTML =
              doc.querySelector("grammar_rules")?.innerHTML || "";
            document.getElementById("vocabulary-content").innerHTML =
              doc.querySelector("vocabulary_boosters")?.innerHTML || "";
            document.getElementById("reading-tips-content").innerHTML =
              doc.querySelector("reading_tips")?.innerHTML || "";
            document.getElementById("motivation-content").innerHTML =
              doc.querySelector("motivation")?.innerHTML || "";

            // Show the guide container
            document
              .getElementById("guide-container")
              .classList.remove("hidden");
          } catch (error) {
            alert("Error generating guide: " + error.message);
          } finally {
            document.getElementById("loading").classList.add("hidden");
          }
        });
    </script>
  </body>
</html>
